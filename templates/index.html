<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Finance AI</title>
  <style>
    :root{
      --bg:#070B18;
      --panel:#0B1024;
      --panel2:#0E1736;
      --text:#EAF0FF;
      --muted:#93A4C7;
      --brand:#4B8CFF;
      --brand2:#2D6BFF;
      --danger:#FF4B6E;
      --ok:#2EE59D;
      --border:rgba(255,255,255,.10);
      --shadow: 0 14px 50px rgba(0,0,0,.55);
      --radius:18px;
      --radius2:26px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 700px at 10% 0%, rgba(75,140,255,.20), transparent 55%),
                  radial-gradient(900px 600px at 90% 25%, rgba(46,229,157,.10), transparent 60%),
                  var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:980px;margin:0 auto;padding:22px 16px 70px}
    .topbar{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:16px}
    .brand h1{margin:0;font-size:28px;letter-spacing:.2px}
    .brand p{margin:6px 0 0;color:var(--muted);font-size:14px}
    .btn{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      color:var(--text);
      padding:10px 14px;
      border-radius:999px;
      cursor:pointer;
      transition:.15s transform, .2s background;
      display:inline-flex;align-items:center;gap:8px;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{
      border-color: rgba(75,140,255,.45);
      background: linear-gradient(180deg, rgba(75,140,255,.35), rgba(45,107,255,.18));
    }
    .btn.danger{
      border-color: rgba(255,75,110,.45);
      background: linear-gradient(180deg, rgba(255,75,110,.28), rgba(255,75,110,.10));
    }
    .pill{
      padding:6px 10px;border-radius:999px;
      border:1px solid var(--border);
      color:var(--muted);
      font-size:12px;
    }

    .tabs{
      display:flex;gap:10px;flex-wrap:wrap;
      padding:8px;border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      margin:14px 0 16px;
      width:fit-content;
    }
    .tab{
      padding:10px 14px;border-radius:999px;
      cursor:pointer;
      color:var(--muted);
      border:1px solid transparent;
      user-select:none;
      font-weight:600;
      font-size:14px;
    }
    .tab.active{
      color:var(--text);
      border-color: rgba(75,140,255,.35);
      background: linear-gradient(180deg, rgba(75,140,255,.26), rgba(75,140,255,.10));
    }

    .grid{display:grid;gap:14px}
    @media(min-width:840px){ .grid.cols2{grid-template-columns:1fr 1fr;} }

    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:16px;
      overflow:hidden;
    }
    .card h2{margin:0 0 8px;font-size:14px;letter-spacing:.4px;color:var(--muted);text-transform:uppercase}
    .card .value{font-size:28px;font-weight:800;margin-top:4px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .spacer{flex:1}
    .muted{color:var(--muted)}
    .field{display:flex;flex-direction:column;gap:8px;margin-top:10px}
    label{font-size:12px;color:var(--muted);letter-spacing:.2px}
    input, select, textarea{
      width:100%;
      border-radius:14px;
      padding:12px 12px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.20);
      color:var(--text);
      outline:none;
    }
    textarea{min-height:92px;resize:vertical}
    .split{display:grid;gap:10px}
    @media(min-width:640px){ .split{grid-template-columns:1fr 1fr;} }

    .toast{
      margin-top:12px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.25);
      display:none;
    }
    .toast.show{display:block}
    .toast.ok{border-color: rgba(46,229,157,.35)}
    .toast.err{border-color: rgba(255,75,110,.35)}
    .toast .t{font-weight:700}
    .toast .d{color:var(--muted);font-size:13px;margin-top:4px}

    /* modal */
    .overlay{
      position:fixed;inset:0;
      background: rgba(0,0,0,.55);
      display:none;align-items:flex-end;justify-content:center;
      padding:16px;
      z-index:50;
    }
    .overlay.show{display:flex}
    .modal{
      width:min(560px, 100%);
      border-radius: 26px;
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(11,16,36,.98), rgba(7,11,24,.98));
      box-shadow: var(--shadow);
      padding:16px;
    }
    .modalHead{display:flex;align-items:center;gap:12px}
    .modalHead h3{margin:0;font-size:20px}
    .x{
      margin-left:auto;
      width:42px;height:42px;border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      cursor:pointer;
      color:var(--text);
      font-size:18px;
    }
    .segTabs{
      margin-top:12px;
      display:flex;
      gap:8px;
      padding:6px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
    }
    .seg{
      flex:1;
      text-align:center;
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      color:var(--muted);
      font-weight:700;
      user-select:none;
    }
    .seg.active{
      color:var(--text);
      background: linear-gradient(180deg, rgba(75,140,255,.26), rgba(75,140,255,.10));
      border:1px solid rgba(75,140,255,.35);
    }
    .hint{font-size:12px;color:var(--muted);margin-top:8px}
    .hidden{display:none !important}
    .divider{height:1px;background:var(--border);margin:14px 0}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <h1>Finance AI</h1>
        <p>Controle financeiro ‚Ä¢ simples e r√°pido</p>
      </div>

      <div class="row">
        <span id="userPill" class="pill hidden"></span>
        <button id="btnLogin" class="btn primary">üîí Login</button>
        <button id="btnLogout" class="btn danger hidden">Sair</button>
      </div>
    </div>

    <div class="tabs" role="tablist" aria-label="Navega√ß√£o">
      <div class="tab" data-tab="lancar">Lan√ßar</div>
      <div class="tab" data-tab="ultimos">√öltimos</div>
      <div class="tab active" data-tab="dashboard">Dashboard</div>
      <div class="tab" data-tab="investimentos">Investimentos</div>
    </div>

    <!-- DASHBOARD -->
    <section id="tab-dashboard" class="grid cols2">
      <div class="card">
        <h2>Dashboard do m√™s</h2>
        <div class="split">
          <div class="field">
            <label>M√™s</label>
            <select id="dashMes"></select>
          </div>
          <div class="field">
            <label>Ano</label>
            <input id="dashAno" inputmode="numeric" placeholder="2026" />
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid" style="gap:10px">
          <div class="card" style="box-shadow:none;border-radius:18px;background:rgba(255,255,255,.03)">
            <div class="row">
              <div class="muted" style="font-weight:800;letter-spacing:.3px">RECEITAS</div>
              <div class="spacer"></div>
              <div id="valReceitas" style="font-weight:900">R$ 0,00</div>
            </div>
          </div>

          <div class="card" style="box-shadow:none;border-radius:18px;background:rgba(255,255,255,.03)">
            <div class="row">
              <div class="muted" style="font-weight:800;letter-spacing:.3px">GASTOS</div>
              <div class="spacer"></div>
              <div id="valGastos" style="font-weight:900">R$ 0,00</div>
            </div>
          </div>

          <div class="card" style="box-shadow:none;border-radius:18px;background:rgba(255,255,255,.03)">
            <div class="row">
              <div class="muted" style="font-weight:800;letter-spacing:.3px">SALDO</div>
              <div class="spacer"></div>
              <div id="valSaldo" style="font-weight:900">R$ 0,00</div>
            </div>
          </div>
        </div>

        <div class="row" style="margin-top:14px">
          <button id="btnAtualizarDash" class="btn primary">Atualizar Dashboard</button>
          <div class="spacer"></div>
          <span class="hint">Dica: fa√ßa login para ver seus dados.</span>
        </div>

        <div id="toastDash" class="toast"></div>
      </div>

      <div class="card">
        <h2>Atalhos</h2>
        <div class="row" style="margin-top:6px;flex-wrap:wrap">
          <button class="btn" id="goLancar">‚ûï Lan√ßar agora</button>
          <button class="btn" id="openLogin2">üîí Abrir login</button>
        </div>
        <div class="divider"></div>
        <p class="muted" style="margin:0;font-size:13px;line-height:1.5">
          Se o dashboard estiver zerado mesmo ap√≥s lan√ßar, confirme se a planilha <b>Controle Financeiro</b> foi compartilhada
          com a Service Account (e-mail do JSON) como <b>Editor</b>.
        </p>
      </div>
    </section>

    <!-- LAN√áAR -->
    <section id="tab-lancar" class="hidden">
      <div class="card">
        <h2>Novo lan√ßamento</h2>

        <div class="split">
          <div class="field">
            <label>Tipo</label>
            <select id="lanTipo">
              <option value="RECEITA">RECEITA</option>
              <option value="GASTO">GASTO</option>
            </select>
          </div>

          <div class="field">
            <label>Data</label>
            <input id="lanData" type="date" />
          </div>
        </div>

        <div class="split">
          <div class="field">
            <label>Categoria</label>
            <input id="lanCategoria" placeholder="Ex: Sal√°rio, Mercado, Transporte..." />
          </div>

          <div class="field">
            <label>Valor (R$)</label>
            <input id="lanValor" inputmode="decimal" placeholder="Ex: 100,00" />
          </div>
        </div>

        <div class="field">
          <label>Descri√ß√£o</label>
          <textarea id="lanDescricao" placeholder="Opcional..."></textarea>
        </div>

        <div class="row" style="margin-top:12px">
          <button id="btnSalvarLanc" class="btn primary">Salvar</button>
          <button id="btnLimparLanc" class="btn">Limpar</button>
          <div class="spacer"></div>
          <span class="hint">Voc√™ precisa estar logado.</span>
        </div>

        <div id="toastLanc" class="toast"></div>
      </div>
    </section>

    <!-- √öLTIMOS -->
    <section id="tab-ultimos" class="hidden">
      <div class="card">
        <h2>√öltimos lan√ßamentos</h2>
        <p class="muted" style="margin:0;line-height:1.6">
          Esta tela est√° pronta no layout. Se voc√™ quiser listar ‚Äú√öltimos‚Äù, eu te passo 2 rotas no <code>app.py</code>:
          <b>GET /api/lancamentos</b> e <b>DELETE /api/lancamentos/:id</b> (ou por linha), e eu atualizo o front pra puxar do Sheets.
        </p>
        <div class="divider"></div>
        <div class="muted">Por enquanto, use ‚ÄúLan√ßar‚Äù e ‚ÄúDashboard‚Äù.</div>
      </div>
    </section>

    <!-- INVESTIMENTOS -->
    <section id="tab-investimentos" class="hidden">
      <div class="card">
        <h2>Investimentos</h2>
        <p class="muted" style="margin:0;line-height:1.6">
          Tela pronta para evoluir. Se voc√™ quiser registrar investimentos no Sheets, eu adiciono no backend:
          <b>POST /api/investimentos</b> e <b>GET /api/investimentos</b>.
        </p>
      </div>
    </section>
  </div>

  <!-- MODAL LOGIN -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Autentica√ß√£o">
      <div class="modalHead">
        <div style="font-size:22px">üîí</div>
        <div>
          <h3 id="modalTitle">Login</h3>
          <div class="hint" id="modalSub">Entre com seu e-mail e senha.</div>
        </div>
        <button class="x" id="closeModal">‚úï</button>
      </div>

      <div class="segTabs" style="margin-top:12px">
        <div class="seg active" data-seg="entrar">Entrar</div>
        <div class="seg" data-seg="criar">Criar conta</div>
        <div class="seg" data-seg="reset">Resetar senha</div>
      </div>

      <!-- ENTRAR -->
      <div id="seg-entrar" style="margin-top:12px">
        <div class="field">
          <label>E-mail</label>
          <input id="loginEmail" type="email" placeholder="seuemail@dominio.com" />
        </div>
        <div class="field">
          <label>Senha</label>
          <input id="loginSenha" type="password" placeholder="Sua senha" />
        </div>

        <div class="row" style="margin-top:12px">
          <button id="btnEntrar" class="btn primary" style="flex:1">Entrar</button>
          <button class="btn" id="btnFechar1">Sair</button>
        </div>

        <div id="toastAuth1" class="toast"></div>
      </div>

      <!-- CRIAR -->
      <div id="seg-criar" class="hidden" style="margin-top:12px">
        <div class="split">
          <div class="field">
            <label>Nome / Apelido</label>
            <input id="regApelido" placeholder="Ex: David" />
          </div>
          <div class="field">
            <label>Telefone (DDD + n√∫mero)</label>
            <input id="regTelefone" inputmode="tel" placeholder="(37) 99999-9999" />
          </div>
        </div>

        <div class="field">
          <label>Nome completo</label>
          <input id="regNomeCompleto" placeholder="Seu nome completo" />
        </div>

        <div class="field">
          <label>E-mail</label>
          <input id="regEmail" type="email" placeholder="seuemail@dominio.com" />
        </div>

        <div class="split">
          <div class="field">
            <label>Senha</label>
            <input id="regSenha" type="password" placeholder="M√≠nimo 6 caracteres" />
          </div>
          <div class="field">
            <label>Confirmar senha</label>
            <input id="regConf" type="password" placeholder="Repita a senha" />
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button id="btnCriarConta" class="btn primary" style="flex:1">Criar conta</button>
          <button class="btn" id="btnFechar2">Sair</button>
        </div>

        <div id="toastAuth2" class="toast"></div>
        <div class="hint">Cadastro √© imediato: voc√™ entra ap√≥s criar.</div>
      </div>

      <!-- RESET -->
      <div id="seg-reset" class="hidden" style="margin-top:12px">
        <div class="field">
          <label>E-mail</label>
          <input id="rstEmail" type="email" placeholder="seuemail@dominio.com" />
        </div>
        <div class="split">
          <div class="field">
            <label>Nova senha</label>
            <input id="rstSenha" type="password" placeholder="M√≠nimo 6 caracteres" />
          </div>
          <div class="field">
            <label>Confirmar</label>
            <input id="rstConf" type="password" placeholder="Repita a senha" />
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button id="btnResetar" class="btn primary" style="flex:1">Resetar senha</button>
          <button class="btn" id="btnFechar3">Sair</button>
        </div>

        <div id="toastAuth3" class="toast"></div>
        <div class="hint">Reset simples (sem e-mail). S√≥ altera a senha no Sheets.</div>
      </div>
    </div>
  </div>

  <script>
    // -----------------------
    // Helpers
    // -----------------------
    const $ = (id) => document.getElementById(id);
    const moneyBR = (n) => {
      const v = Number(n || 0);
      return v.toLocaleString("pt-BR", { style:"currency", currency:"BRL" });
    };

    async function api(path, method="GET", body=null) {
      const opt = {
        method,
        headers: { "Content-Type":"application/json" },
        credentials: "include"
      };
      if (body) opt.body = JSON.stringify(body);
      const res = await fetch(path, opt);
      let data = null;
      try { data = await res.json(); } catch(e) {}
      if (!res.ok) {
        const msg = (data && (data.error || data.message)) ? (data.error || data.message) : `Erro ${res.status}`;
        throw new Error(msg);
      }
      return data;
    }

    function showToast(el, type, title, desc="") {
      el.className = "toast show " + (type === "ok" ? "ok" : "err");
      el.innerHTML = `<div class="t">${title}</div>` + (desc ? `<div class="d">${desc}</div>` : "");
    }
    function hideToast(el) {
      el.className = "toast";
      el.innerHTML = "";
    }

    // -----------------------
    // Tabs
    // -----------------------
    const tabEls = Array.from(document.querySelectorAll(".tab"));
    function setTab(name) {
      tabEls.forEach(t => t.classList.toggle("active", t.dataset.tab === name));
      ["dashboard","lancar","ultimos","investimentos"].forEach(n => {
        const sec = $("tab-" + n);
        sec.classList.toggle("hidden", n !== name);
      });
      if (name === "dashboard") refreshDashboard().catch(()=>{});
    }
    tabEls.forEach(t => t.addEventListener("click", () => setTab(t.dataset.tab)));

    $("goLancar").addEventListener("click", () => setTab("lancar"));
    $("openLogin2").addEventListener("click", () => openModal("entrar"));

    // -----------------------
    // Modal
    // -----------------------
    const overlay = $("overlay");
    const segs = Array.from(document.querySelectorAll(".seg"));

    function openModal(seg="entrar") {
      overlay.classList.add("show");
      overlay.setAttribute("aria-hidden", "false");
      setSeg(seg);
    }
    function closeModal() {
      overlay.classList.remove("show");
      overlay.setAttribute("aria-hidden", "true");
      // limpar toasts
      [$("toastAuth1"),$("toastAuth2"),$("toastAuth3")].forEach(hideToast);
    }

    function setSeg(seg) {
      segs.forEach(s => s.classList.toggle("active", s.dataset.seg === seg));
      $("seg-entrar").classList.toggle("hidden", seg !== "entrar");
      $("seg-criar").classList.toggle("hidden", seg !== "criar");
      $("seg-reset").classList.toggle("hidden", seg !== "reset");

      if (seg === "entrar") { $("modalTitle").textContent = "Login"; $("modalSub").textContent = "Entre com seu e-mail e senha."; }
      if (seg === "criar")  { $("modalTitle").textContent = "Criar conta"; $("modalSub").textContent = "Crie sua conta para acessar seus lan√ßamentos."; }
      if (seg === "reset")  { $("modalTitle").textContent = "Resetar senha"; $("modalSub").textContent = "Defina uma nova senha para sua conta."; }
    }

    segs.forEach(s => s.addEventListener("click", () => setSeg(s.dataset.seg)));
    $("btnLogin").addEventListener("click", () => openModal("entrar"));
    $("closeModal").addEventListener("click", closeModal);
    $("btnFechar1").addEventListener("click", closeModal);
    $("btnFechar2").addEventListener("click", closeModal);
    $("btnFechar3").addEventListener("click", closeModal);
    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeModal(); });

    // -----------------------
    // Auth state (front only)
    // -----------------------
    let currentUserEmail = localStorage.getItem("financeai_user") || "";

    function setLoggedUI(isLogged, email="") {
      const pill = $("userPill");
      const btnLogin = $("btnLogin");
      const btnLogout = $("btnLogout");

      if (isLogged) {
        pill.textContent = email;
        pill.classList.remove("hidden");
        btnLogin.classList.add("hidden");
        btnLogout.classList.remove("hidden");
      } else {
        pill.classList.add("hidden");
        btnLogin.classList.remove("hidden");
        btnLogout.classList.add("hidden");
      }
    }

    // tenta assumir logado pelo localStorage (a sess√£o real √© no servidor)
    if (currentUserEmail) setLoggedUI(true, currentUserEmail);
    else setLoggedUI(false);

    $("btnLogout").addEventListener("click", async () => {
      try{
        await api("/api/logout", "POST");
      }catch(e){}
      localStorage.removeItem("financeai_user");
      currentUserEmail = "";
      setLoggedUI(false);
      refreshDashboard().catch(()=>{});
    });

    // -----------------------
    // Auth actions
    // -----------------------
    $("btnEntrar").addEventListener("click", async () => {
      const t = $("toastAuth1"); hideToast(t);
      try{
        const email = $("loginEmail").value.trim().toLowerCase();
        const senha = $("loginSenha").value;
        const res = await api("/api/login", "POST", { email, senha });
        localStorage.setItem("financeai_user", res.email);
        currentUserEmail = res.email;
        setLoggedUI(true, res.email);
        showToast(t, "ok", "Login realizado", "Voc√™ j√° pode lan√ßar e ver o dashboard.");
        setTimeout(() => { closeModal(); refreshDashboard().catch(()=>{}); }, 600);
      }catch(e){
        showToast(t, "err", "Falha no login", e.message);
      }
    });

    $("btnCriarConta").addEventListener("click", async () => {
      const t = $("toastAuth2"); hideToast(t);
      try{
        const nome_apelido = $("regApelido").value.trim();
        const nome_completo = $("regNomeCompleto").value.trim();
        const telefone = $("regTelefone").value.trim();
        const email = $("regEmail").value.trim().toLowerCase();
        const senha = $("regSenha").value;
        const confirmar_senha = $("regConf").value;

        const res = await api("/api/register", "POST", {
          nome_apelido, nome_completo, telefone, email, senha, confirmar_senha
        });

        localStorage.setItem("financeai_user", res.email);
        currentUserEmail = res.email;
        setLoggedUI(true, res.email);

        showToast(t, "ok", "Conta criada", "Cadastro feito! Voc√™ j√° est√° logado.");
        setTimeout(() => { closeModal(); refreshDashboard().catch(()=>{}); }, 600);
      }catch(e){
        showToast(t, "err", "Erro ao cadastrar", e.message);
      }
    });

    $("btnResetar").addEventListener("click", async () => {
      const t = $("toastAuth3"); hideToast(t);
      try{
        const email = $("rstEmail").value.trim().toLowerCase();
        const nova_senha = $("rstSenha").value;
        const confirmar = $("rstConf").value;

        await api("/api/reset_password", "POST", { email, nova_senha, confirmar });
        showToast(t, "ok", "Senha alterada", "Agora voc√™ j√° pode entrar com a nova senha.");
      }catch(e){
        showToast(t, "err", "Falha no reset", e.message);
      }
    });

    // -----------------------
    // Dashboard
    // -----------------------
    function initMesAno() {
      const sel = $("dashMes");
      const now = new Date();
      const meses = [
        "Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho",
        "Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"
      ];
      sel.innerHTML = meses.map((m, i) => `<option value="${i+1}">${m}</option>`).join("");
      sel.value = String(now.getMonth()+1);
      $("dashAno").value = String(now.getFullYear());
      $("lanData").value = now.toISOString().slice(0,10);
    }

    async function refreshDashboard() {
      const toast = $("toastDash");
      hideToast(toast);

      const mes = Number($("dashMes").value);
      const ano = Number($("dashAno").value);

      try{
        const res = await api(`/api/dashboard?mes=${mes}&ano=${ano}`, "GET");
        $("valReceitas").textContent = moneyBR(res.receitas);
        $("valGastos").textContent = moneyBR(res.gastos);
        $("valSaldo").textContent = moneyBR(res.saldo);
      }catch(e){
        // se n√£o estiver logado, o backend retorna 401
        $("valReceitas").textContent = "R$ 0,00";
        $("valGastos").textContent = "R$ 0,00";
        $("valSaldo").textContent = "R$ 0,00";
        showToast(toast, "err", "Fa√ßa login para ver o dashboard", e.message);
      }
    }

    $("btnAtualizarDash").addEventListener("click", () => refreshDashboard());

    // -----------------------
    // Lan√ßamentos
    // -----------------------
    $("btnSalvarLanc").addEventListener("click", async () => {
      const toast = $("toastLanc");
      hideToast(toast);

      try{
        const tipo = $("lanTipo").value;
        const data = $("lanData").value;
        const categoria = $("lanCategoria").value.trim();
        const descricao = $("lanDescricao").value.trim();
        const valor = $("lanValor").value.trim();

        await api("/api/lancamentos", "POST", { tipo, data, categoria, descricao, valor });

        showToast(toast, "ok", "Salvo!", "Lan√ßamento registrado com sucesso.");
        // limpar campos b√°sicos
        $("lanCategoria").value = "";
        $("lanDescricao").value = "";
        $("lanValor").value = "";
        // atualiza dashboard
        refreshDashboard().catch(()=>{});
      }catch(e){
        showToast(toast, "err", "Erro ao salvar", e.message);
      }
    });

    $("btnLimparLanc").addEventListener("click", () => {
      $("lanCategoria").value = "";
      $("lanDescricao").value = "";
      $("lanValor").value = "";
      hideToast($("toastLanc"));
    });

    // -----------------------
    // Boot
    // -----------------------
    initMesAno();
    refreshDashboard().catch(()=>{});
  </script>
</body>
</html>
